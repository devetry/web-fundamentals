<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>Get It Done! Part 2: Database Configuration :: Unit 2: Web Fundamentals</title>

        <link rel="stylesheet" href="/css/bootstrap.min.css">
        <link rel="stylesheet" href="/css/highlight.launchcode.css">
        <link rel="stylesheet" href="/css/main.css">
        <link rel="stylesheet" href="https://djwbyvgln9kts.cloudfront.net/launch_ed_style/custom.css">
    </head>
    <body>

        <header class="navbar navbar-default navbar-fixed-top">

            <ul class="nav navbar-nav">

                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle glyphicon glyphicon-menu-hamburger" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"></a>
                        <ul class="dropdown-menu">
                                                            <li class=" lc-button">
                                    <a href="/classes/">
                                        Classes
                                    </a>
                                </li>
                                                            <li class=" lc-button">
                                    <a href="/studios/">
                                        Studios
                                    </a>
                                </li>
                                                            <li class=" lc-button">
                                    <a href="/tutorials/">
                                        Tutorials
                                    </a>
                                </li>
                                                            <li class=" lc-button">
                                    <a href="/assignments/">
                                        Assignments
                                    </a>
                                </li>
                                                            <li class="active lc-button">
                                    <a href="/videos/">
                                        Videos
                                    </a>
                                </li>
                                                            <li class=" lc-button">
                                    <a href="/cheatsheets/">
                                        Cheatsheets
                                    </a>
                                </li>
                                                            <li class=" lc-button">
                                    <a href="/objectives/">
                                        Objectives
                                    </a>
                                </li>
                                                            <li class=" lc-button">
                                    <a href="/issues/">
                                        Issues
                                    </a>
                                </li>
                                                            <li class=" lc-button">
                                    <a href="/about/">
                                        About this Unit
                                    </a>
                                </li>
                                                        <li role="separator" class="divider"></li>
                            <li>
                                <a href="#modalSearch" data-toggle="modal" data-target="#modalSearch">Search This Site</a>
                            </li>
                        </ul>
                    </li>

                
            </ul>


            <div>
                <a class="navbar-brand site-title navbar-center" href="/">
                    <h1>Unit 2: Web Fundamentals</h1>
                </a>
            </div>

            <div class="nav navbar-nav navbar-right">
                <a class="navbar-brand dabomb" href="/"></a>
            </div>

        </header>

        <nav style="position:absolute; width: 180px; margin-top:64px">
            <ul class="nav navbar-big-nav hidden-md hidden-sm hidden-xs">
                                                            <li class=" lc-button">
                            <a href="/classes/">
                                Classes
                            </a>
                        </li>
                                            <li class=" lc-button">
                            <a href="/studios/">
                                Studios
                            </a>
                        </li>
                                            <li class=" lc-button">
                            <a href="/tutorials/">
                                Tutorials
                            </a>
                        </li>
                                            <li class=" lc-button">
                            <a href="/assignments/">
                                Assignments
                            </a>
                        </li>
                                            <li class="active lc-button">
                            <a href="/videos/">
                                Videos
                            </a>
                        </li>
                                            <li class=" lc-button">
                            <a href="/cheatsheets/">
                                Cheatsheets
                            </a>
                        </li>
                                            <li class=" lc-button">
                            <a href="/objectives/">
                                Objectives
                            </a>
                        </li>
                                            <li class=" lc-button">
                            <a href="/issues/">
                                Issues
                            </a>
                        </li>
                                            <li class=" lc-button">
                            <a href="/about/">
                                About this Unit
                            </a>
                        </li>
                                        <li role="separator" class="divider"></li>
                    <li>
                        <a href="#modalSearch" data-toggle="modal" data-target="#modalSearch">Search This Site</a>
                    </li>
                            </ul>
        </nav>


        <!-- Search Modal -->
        <div id="modalSearch" class="modal fade" role="dialog">
           <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                   <button type="button" class="close" data-dismiss="modal">&times;</button>
                   <h4 class="modal-title">Search Unit 2: Web Fundamentals</h4>
                </div>
                <div class="modal-body">
                    <script>
                      (function() {
                        var cx = "018398152828724587795:xxg-p_lz3vg";
                        var gcse = document.createElement('script');
                        gcse.type = 'text/javascript';
                        gcse.async = true;
                        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
                        var s = document.getElementsByTagName('script')[0];
                        s.parentNode.insertBefore(gcse, s);
                      })();
                    </script>
                    <gcse:search></gcse:search>
                </div>
                <div class="modal-footer">
                   <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>

           </div>
        </div>

        <main class="container-fluid">
            <div class="row">

                <section id="content" class="col-sm-offset-1 col-sm-10 col-md-offset-2 col-md-8">
                                        <h1>Get It Done! Part 2: Database Configuration</h1>
                    <div class="youtube-wrapper"><iframe width="776" height="437" src="https://www.youtube-nocookie.com/embed/-bvlj_3Im6s?rel=0" frameborder="0" allowfullscreen></iframe></div>
<h2 id="notes">Notes</h2>
<p>Begin by starting MAMP, starting the servers, and going to phpMyAdmin.</p>
<p>Now we'll create a new user and database for our <em>Get It Done!</em> application. A good design principle is that for each application you have one database, for each database, one user. This keeps privileges and permissions separated across applications. You can review the basic steps in written form <a href="../../../studios/databases/2/#database-setup">here</a>.</p>
<p>If you don't already have <code>flask-env</code> activated, activate it now. Then run:</p>
<pre><code class="language-nohighlight">conda install -c conda-forge flask-sqlalchemy</code></pre>
<p>After this installation completes, run the following:</p>
<aside class="aside-warning">
<p>Windows Git Bash users will need to deactivate <code>flask-env</code> and close their terminal, then open a new Git Bash terminal, navigate to this directory, and activate <code>flask-env</code> again before proceeding to use the install command below.    </p>
</aside>
<pre><code class="language-nohighlight">conda install pymysql</code></pre>
<aside class="aside-warning">
<p>And again it is advisable for Windows Git Bash to close their terminal, then open a new Git Bash terminal, navigate to this directory and activate <code>flask-env</code> before continuing.  </p>
</aside>
<p>Now, amend your <code>main.py</code> by adding the following four lines:</p>
<pre><code class="language-python">from flask_sqlalchemy import SQLAlchemy </code></pre>
<pre><code class="language-python"># Note: the connection string after :// contains the following info:
# user:password@server:portNumber/databaseName

app.config['SQLALCHEMY_DATABASE_URI'] = 'mysql+pymysql://get-it-done:beproductive@localhost:8889/get-it-done'</code></pre>
<aside class="aside-pro-tip">
<p>Two primary sources of bugs when running an application using a database are:</p>
<ol>
<li>The database is not running.</li>
<li>The connection string is not correct.</li>
</ol>
<p>So if your application isn't working, be sure to check that you've started the MySQL server and that you have the correct information (especially port number, user and password) in the connection string!    </p>
</aside>
<pre><code class="language-python">app.config['SQLALCHEMY_ECHO'] = True</code></pre>
<pre><code class="language-python">db = SQLAlchemy(app)</code></pre>
<p>Next we'll continue modifying <code>main.py</code> and create a persistent class for database data: </p>
<pre><code class="language-python">class Task(db.Model):

    id = db.Column(db.Integer, primary_key=True)
    name = db.Column(db.String(120))

    def __init__(self, name):
        self.name = name</code></pre>
<p>Be sure to shield <code>app.run</code> by enclosing it in an <code>if</code> condition:</p>
<pre><code class="language-python">if __name__ == '__main__':
    app.run()</code></pre>
<p>Back in the terminal, start a python shell by running the command <code>python</code>. Then import <code>db</code> and create the tables:</p>
<pre><code class="language-nohighlight">&gt; from main import db,Task
&gt; db.create_all()</code></pre>
<p>Now run the following commands one at a time to add data to the database:</p>
<pre><code class="language-nohighlight">&gt;&gt;&gt; new_task = Task('finish ORM lesson 2')
&gt;&gt;&gt; db.session.add(new_task)
&gt;&gt;&gt; another_task = Task('post lesson video')
&gt;&gt;&gt; db.session.add(another_task)
&gt;&gt;&gt; db.session.commit()</code></pre>
<p>To get data from the database, run the following:</p>
<pre><code class="language-nohighlight">&gt;&gt;&gt; tasks = Task.query.all()
&gt;&gt;&gt; tasks[0].name</code></pre>
<h2 id="code">Code</h2>
<p>View the <a href="https://github.com/LaunchCodeEducation/get-it-done/tree/7e8a99b421e8c1564c65de1ef30865c64e708e6d">final code</a> for this lesson.</p>
<h2 id="references">References</h2>
<ul>
<li><a href="http://www.sqlalchemy.org/">SQLAlchemy</a></li>
<li><a href="http://flask-sqlalchemy.pocoo.org/2.1/">Flask SQLAlchemy</a></li>
</ul>
                                    </section>

            </div>
        </main>

        <script type="text/javascript" src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
        <script type="text/javascript" src="/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="/js/highlight.pack.js"></script>
        <script type="text/javascript" src="/js/libgif.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.5.3/vue.min.js"></script>

        <script>
            $(function() {
                $("section>h1").wrap('<div class="page-header" />');

                // Syntax highlighting
                hljs.configure({ displayLabels: true });
                hljs.initHighlightingOnLoad();
            });
        </script>
        <script>
            $(function() {
                if (!location.pathname.match(/class-prep/)) return;

                window.checkboxWatcher = new Vue({
                    el: '#content',
                    data: function() {
                        var storedValue = localStorage.getItem('completedChecks');
                        console.log('storedValue', storedValue);
                        var hydratedValue = storedValue ? JSON.parse(storedValue) : {};
                        return {
                            checks: hydratedValue,
                        };
                    },
                    watch: {
                        checks: {
                            handler: function() {
                                console.log('storing check state');
                                localStorage.setItem('completedChecks', JSON.stringify(this.checks));
                            },
                            deep: true,
                        },
                    },
                });
            });
        </script>
        
    </body>
</html>
