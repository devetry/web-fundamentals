<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>Studio: FlickList 7 :: Unit 2: Web Fundamentals</title>

        <link rel="stylesheet" href="/css/bootstrap.min.css">
        <link rel="stylesheet" href="/css/highlight.launchcode.css">
        <link rel="stylesheet" href="/css/main.css">
        <link rel="stylesheet" href="https://djwbyvgln9kts.cloudfront.net/launch_ed_style/custom.css">
    </head>
    <body>

        <header class="navbar navbar-default navbar-fixed-top">

            <ul class="nav navbar-nav">

                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle glyphicon glyphicon-menu-hamburger" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"></a>
                        <ul class="dropdown-menu">
                                                            <li class=" lc-button">
                                    <a href="/classes/">
                                        Classes
                                    </a>
                                </li>
                                                            <li class="active lc-button">
                                    <a href="/studios/">
                                        Studios
                                    </a>
                                </li>
                                                            <li class=" lc-button">
                                    <a href="/tutorials/">
                                        Tutorials
                                    </a>
                                </li>
                                                            <li class=" lc-button">
                                    <a href="/assignments/">
                                        Assignments
                                    </a>
                                </li>
                                                            <li class=" lc-button">
                                    <a href="/videos/">
                                        Videos
                                    </a>
                                </li>
                                                            <li class=" lc-button">
                                    <a href="/cheatsheets/">
                                        Cheatsheets
                                    </a>
                                </li>
                                                            <li class=" lc-button">
                                    <a href="/objectives/">
                                        Objectives
                                    </a>
                                </li>
                                                            <li class=" lc-button">
                                    <a href="/issues/">
                                        Issues
                                    </a>
                                </li>
                                                            <li class=" lc-button">
                                    <a href="/about/">
                                        About this Unit
                                    </a>
                                </li>
                                                        <li role="separator" class="divider"></li>
                            <li>
                                <a href="#modalSearch" data-toggle="modal" data-target="#modalSearch">Search This Site</a>
                            </li>
                        </ul>
                    </li>

                
            </ul>


            <div>
                <a class="navbar-brand site-title navbar-center" href="/">
                    <h1>Unit 2: Web Fundamentals</h1>
                </a>
            </div>

            <div class="nav navbar-nav navbar-right">
                <a class="navbar-brand dabomb" href="/"></a>
            </div>

        </header>

        <nav style="position:absolute; width: 180px; margin-top:64px">
            <ul class="nav navbar-big-nav hidden-md hidden-sm hidden-xs">
                                                            <li class=" lc-button">
                            <a href="/classes/">
                                Classes
                            </a>
                        </li>
                                            <li class="active lc-button">
                            <a href="/studios/">
                                Studios
                            </a>
                        </li>
                                            <li class=" lc-button">
                            <a href="/tutorials/">
                                Tutorials
                            </a>
                        </li>
                                            <li class=" lc-button">
                            <a href="/assignments/">
                                Assignments
                            </a>
                        </li>
                                            <li class=" lc-button">
                            <a href="/videos/">
                                Videos
                            </a>
                        </li>
                                            <li class=" lc-button">
                            <a href="/cheatsheets/">
                                Cheatsheets
                            </a>
                        </li>
                                            <li class=" lc-button">
                            <a href="/objectives/">
                                Objectives
                            </a>
                        </li>
                                            <li class=" lc-button">
                            <a href="/issues/">
                                Issues
                            </a>
                        </li>
                                            <li class=" lc-button">
                            <a href="/about/">
                                About this Unit
                            </a>
                        </li>
                                        <li role="separator" class="divider"></li>
                    <li>
                        <a href="#modalSearch" data-toggle="modal" data-target="#modalSearch">Search This Site</a>
                    </li>
                            </ul>
        </nav>


        <!-- Search Modal -->
        <div id="modalSearch" class="modal fade" role="dialog">
           <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                   <button type="button" class="close" data-dismiss="modal">&times;</button>
                   <h4 class="modal-title">Search Unit 2: Web Fundamentals</h4>
                </div>
                <div class="modal-body">
                    <script>
                      (function() {
                        var cx = "";
                        var gcse = document.createElement('script');
                        gcse.type = 'text/javascript';
                        gcse.async = true;
                        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
                        var s = document.getElementsByTagName('script')[0];
                        s.parentNode.insertBefore(gcse, s);
                      })();
                    </script>
                    <gcse:search></gcse:search>
                </div>
                <div class="modal-footer">
                   <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>

           </div>
        </div>

        <main class="container-fluid">
            <div class="row">

                <section id="content" class="col-sm-offset-1 col-sm-10 col-md-offset-2 col-md-8">
                                        <h1>Studio: FlickList 7</h1>
                    <p>Today we'll add <em>Users</em> to our application, and allow them to log in, log out, and create accounts. We'll learn how to store state in a user's session.  We'll learn about <em>flash messages</em>, which let us overlay messages onto the next page the user visits.</p>
<p>You are encouraged to code along, which, as usual, you can do by checking out the <code>walkthrough7</code> branch.</p>
<h2 id="walkthrough">Walkthrough</h2>
<p>Thus far, our web app does not have a concept of user accounts built in. As a result, there is only one &quot;communal&quot; movie list, and all the users who visit our site work &quot;collaboratively&quot; on that list. That's kind of cool, maybe, but our goal is a site where each user manages her own list, without interference from other users.</p>
<p>The goal today, at a high level, is to implement the existence of user accounts and registration, and ensure that users cannot see the main pages of the site unless they are logged in.</p>
<p>More specifically, in today's walkthough we will update our codebase with the following additions:</p>
<ul>
<li>
<p>A <code>User</code> class to represent and save users in our database.</p>
</li>
<li>
<p>New routes and methods: <code>register</code> and <code>logout</code>.</p>
</li>
<li>
<p>A new template for the <code>register</code> page.</p>
</li>
<li>
<p>Our <code>base</code> template will display either the user's email or links to login and register.</p>
</li>
<li>
<p>A 'login wall' that monitors requests of unlogged-in users, and prompts them to create an account if they're not logged in.</p>
</li>
<li>
<p>Our <code>base</code> template will display flash messages, so that we can tell the user things like &quot;that is not a valid email address&quot;.</p>
</li>
</ul>
<h2 id="studio">Studio</h2>
<p>Right now the only way to login is as a side-effect of creating a new account. It'd be neat if once users created accounts and logged out, they could log back in using their existing email and password, so we'll implement that in this studio. We'll also add validation and authentication for the login process.</p>
<h3 id="checking-out-the-studio-code">Checking out the Studio code</h3>
<p>Follow the <a href="../getting-the-code/">instructions for getting the code</a> in order to get the starter code for <code>studio7</code>.</p>
<h3 id="before-you-begin-create-the-user-db-table-locally">Before you begin: create the 'user' DB table locally</h3>
<pre><code class="language-nohighlight">(flicklist) $ python
&gt;&gt;&gt; from main import db, User
...
&gt;&gt;&gt; db.create_all()
...
&gt;&gt;&gt; db.session.commit()
User.query.all()
...
[]
</code></pre>
<h3 id="your-tasks">Your Tasks</h3>
<ol>
<li>
<p>When a user tries to create an account, but supplies different 'password' and 'verify' fields, redirect them back to <code>/register</code> and flash them a message about why their attempt to create an account failed.</p>
</li>
<li>
<p>Log out, and see what happens when you try to create a user that already exists. This happens because we passed the <code>unique=True</code> keyword param to the <code>email = db.Column()</code> invocation in the <code>User</code> class. When we wear our DB Admin hats, we're happy to get this error, but when we wear our UX designer hats, we want something friendlier. Before creating an account, search the database for an existing account with that email. If it exists already, redirect them back to <code>/register</code> and tell them why their account creation failed.</p>
</li>
<li>
<p>Add a new route for <code>/login</code>, that responds to GET and renders a <code>login.html</code> template; it also needs to respond to POST requests and provide error messages for failed login attempts or redirect to the main page if it is a successful login.</p>
</li>
<li>
<p>Create the <code>login.html</code> template, with form fields for email and password.</p>
</li>
<li>
<p>Test out your new route - one problem you will notice is that you get redirected to the <code>register.html</code> page. Change the login wall to allow this route through.</p>
</li>
</ol>
<h2 id="retrospective">Retrospective</h2>
<p>We've created users and managed the login and logout process. But the <code>User</code> model doesn't relate at all to our <code>Movie</code> model. In the next studio, we'll cross the streams and store movies on a per-user basis.</p>
                                    </section>

            </div>
        </main>

        <script type="text/javascript" src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
        <script type="text/javascript" src="/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="/js/highlight.pack.js"></script>
        <script type="text/javascript" src="/js/libgif.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.5.3/vue.min.js"></script>

        <script>
            $(function() {
                $("section>h1").wrap('<div class="page-header" />');

                // Syntax highlighting
                hljs.configure({ displayLabels: true });
                hljs.initHighlightingOnLoad();
            });
        </script>
        <script>
            $(function() {
                if (!location.pathname.match(/class-prep/)) return;

                window.checkboxWatcher = new Vue({
                    el: '#content',
                    data: function() {
                        var storedValue = localStorage.getItem('completedChecks');
                        console.log('storedValue', storedValue);
                        var hydratedValue = storedValue ? JSON.parse(storedValue) : {};
                        return {
                            checks: hydratedValue,
                        };
                    },
                    watch: {
                        checks: {
                            handler: function() {
                                console.log('storing check state');
                                localStorage.setItem('completedChecks', JSON.stringify(this.checks));
                            },
                            deep: true,
                        },
                    },
                });
            });
        </script>
        
    </body>
</html>
